#!/usr/bin/env node

const program = require('commander');
const inquirer = require('inquirer');
const chalk = require('chalk');

const gitAccount = require('..');

program.parse(process.argv);

gitAccount.loadConfig()
	.then(users => {
		const question = [{
			type: 'list',
			name: 'user',
			message: 'choose one',
			choices: users.map(value => ({
				name: `${value.name} <${value.email}>`,
				value
			}))
		}];
		return inquirer.prompt(question);
	})
	.then(answers => {
		gitAccount.switchAccount(answers.user)
			.then(() => console.log(chalk.green('Switched')));
	})
	.catch(err => console.log(err.message));
